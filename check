import { useRef } from 'react';


import classes from './UserForm.module.css';


function UserForm(props) {
    const personNameRef = useRef();
    const personPostRef = useRef();
    const personEmailRef = useRef();

    var itemsJsonArray = [];
    var itemsJsonArrayStr = "";

    function AddPerson(event) {
        // console.log(props)
        event.preventDefault();

        const enteredName = personNameRef.current.value;
        const enteredPost = personPostRef.current.value;
        const enteredEmail = personEmailRef.current.value;
        console.log(enteredName, enteredPost, enteredEmail);

        if (localStorage.getItem('itemsJson') == null) {
            itemsJsonArray = [];
            itemsJsonArray.push([enteredName, enteredPost, enteredEmail]);
            localStorage.setItem('itemsJson', JSON.stringify(itemsJsonArray));
        }
        else {
            itemsJsonArrayStr = localStorage.getItem('itemsJson');
            itemsJsonArray = JSON.parse(itemsJsonArrayStr);
            itemsJsonArray.push([enteredName, enteredPost, enteredEmail]);
            localStorage.setItem('itemsJson', JSON.stringify(itemsJsonArray));
        }
        console.log("sabse asli=", itemsJsonArray)
        props.func(itemsJsonArray);

        update();
    }

    function update() {
        console.log("updating...Update func");
        console.log("itemsJsonarray=", itemsJsonArray)
        if (localStorage.getItem('itemsJson') == null) {
            console.log("if..")
            itemsJsonArray = [];
            localStorage.setItem('itemsJson', JSON.stringify(itemsJsonArray))
        }
        else {
            console.log("else..")
            itemsJsonArrayStr = localStorage.getItem('itemsJson');
            itemsJsonArray = JSON.parse(itemsJsonArrayStr)
        }
        console.log("itemsJsonarray=", itemsJsonArray)
        // props.func(itemsJsonArray);
    }

    update();
    // AddPerson();

    return (
        <div className={classes.mainBox}>
            <div>
                {
                    // <ListItem/>
                }
            </div>
            <form onSubmit={AddPerson}>
                <div>
                    <input placeholder="Name" type="text" required id="name" ref={personNameRef}></input>
                </div>
                <div>
                    <label for="posts">Post:</label>
                    <select id="posts" name="posts" ref={personPostRef}>
                        <option value="Client Manager">Client Manager</option>
                        <option value="Senior Manager">Senior Manager</option>
                        <option value="Recruitment Success">Recruitment Success</option>
                        <option value="Senior Recruiter">Senior Recruiter</option>
                        <option value="Talent Acquisition">Talent Acquisition</option>
                    </select>
                </div>
                <div>
                    <input placeholder="Email" type="text" required id="email" ref={personEmailRef}></input>
                </div>
                <div>
                    <input type="submit"></input>
                </div>
            </form>
            <input type="button" value="clear Storage" onClick={props.onDelete}></input>
        </div>
    )
}

export default UserForm;